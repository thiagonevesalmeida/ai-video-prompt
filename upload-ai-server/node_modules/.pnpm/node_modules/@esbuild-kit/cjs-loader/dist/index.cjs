"use strict";var j=require("path"),y=require("fs"),g=require("module"),r=require("@esbuild-kit/core-utils"),l=require("get-tsconfig");function f(s){return s&&typeof s=="object"&&"default"in s?s:{default:s}}var d=f(j),E=f(y),u=f(g);const x=/^\.{0,2}\//,O=/\.[cm]?tsx?$/,P=`${d.default.sep}node_modules${d.default.sep}`,i=process.env.ESBK_TSCONFIG_PATH?{path:d.default.resolve(process.env.ESBK_TSCONFIG_PATH),config:l.parseTsconfig(process.env.ESBK_TSCONFIG_PATH)}:l.getTsconfig(),h=i&&l.createFilesMatcher(i),T=i&&l.createPathsMatcher(i),F=r.installSourceMapSupport(),M=r.compareNodeVersion([13,2,0])>=0||r.compareNodeVersion([12,20,0])>=0&&r.compareNodeVersion([13,0,0])<0,m=u.default._extensions,A=m[".js"],b=[".js",".cjs",".cts",".mjs",".mts",".ts",".tsx",".jsx"];function N(s,e){if(!b.some(t=>e.endsWith(t)))return A(s,e);process.send&&process.send({type:"dependency",path:e});let o=E.default.readFileSync(e,"utf8");if(e.endsWith(".cjs")&&M){const t=r.transformDynamicImport(e,o);t&&(o=F(t,e))}else{const t=r.transformSync(o,e,{tsconfigRaw:h==null?void 0:h(e)});o=F(t,e)}s._compile(o,e)}[".js",".ts",".tsx",".jsx"].forEach(s=>{m[s]=N}),Object.defineProperty(m,".mjs",{value:N,enumerable:!1});const D=r.compareNodeVersion([16,0,0])>=0||r.compareNodeVersion([14,18,0])>=0,p=u.default._resolveFilename;u.default._resolveFilename=function(s,e,n,o){var t;if(!D&&s.startsWith("node:")&&(s=s.slice(5)),T&&!x.test(s)&&!((t=e==null?void 0:e.filename)!=null&&t.includes(P))){const a=T(s);for(const _ of a){const v=S.call(this,_,e,n,o);if(v)return v;try{return p.call(this,_,e,n,o)}catch{}}}const c=S.call(this,s,e,n,o);return c||p.call(this,s,e,n,o)};function S(s,e,n,o){const t=r.resolveTsPath(s);if(e!=null&&e.filename&&O.test(e.filename)&&t)try{return p.call(this,t,e,n,o)}catch(c){const{code:a}=c;if(a!=="MODULE_NOT_FOUND"&&a!=="ERR_PACKAGE_PATH_NOT_EXPORTED")throw c}}
